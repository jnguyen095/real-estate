function inactivePostHandler(){$(".inactive-post").click(function(){var t=$(this).data("post");bootbox.confirm("Bạn đã chắc chắn không hiễn thị tin rao này?",function(e){e&&($("#productId").val(t),$("#crudaction").val("inactive"),$("#frmPost").submit())})})}function activePostHandler(){$(".active-post").click(function(){var t=$(this).data("post");$("#productId").val(t),$("#crudaction").val("active"),$("#frmPost").submit()})}function deletePostHandler(){$(".remove-post").click(function(){var t=$(this).data("post");bootbox.confirm("Bạn đã chắc chắn xóa tin rao này chưa?",function(e){e&&($("#productId").val(t),$("#crudaction").val("delete"),$("#frmPost").submit())})})}function refreshPostHandler(){$(".refresh-post").click(function(){var t=$(this).data("post");$("#productId").val(t),$("#crudaction").val("refresh"),$("#frmPost").submit()})}function autoComplete(){$(".typeahead").length>0&&$(".typeahead").typeahead({hint:!0,highlight:!0,minLength:2},{name:"states",async:!0,displayKey:"Street",source:function(t,e){return $.get(urls.findStreetByNameUrl,{query:t},function(t){if(getGeoFromAddress(),null!=t&&t.length>0){var n=$.parseJSON(t);return getGeoFromAddress(),e(n)}})}})}function loadWardByDistrictId(){$("#txtDistrict").change(function(){var t=$(this).val();jQuery.ajax({type:"POST",url:urls.loadWardByDistrictId,dataType:"json",data:{districtId:t},success:function(t){document.getElementById("txtWard").options.length=1;for(key in t)$("#txtWard").append("<option value='"+t[key].WardID+"'>"+t[key].WardName+"</option>");getGeoFromAddress()}})})}function loadDistrictByCityId(){$("#txtCity").change(function(){var t=$(this).val();document.getElementById("txtWard").options.length=1,jQuery.ajax({type:"POST",url:urls.loadDistrictByCityId,dataType:"json",data:{cityId:t},success:function(t){document.getElementById("txtDistrict").options.length=1;for(key in t)$("#txtDistrict").append("<option value='"+t[key].DistrictID+"'>"+t[key].DistrictName+"</option>");getGeoFromAddress()}})})}function uploadMultipleImages(){$(".finish-upload").click(function(){$(".finish-upload .finish-text").hide(),$(".finish-upload .loadUploadOthers").show();var t=document.getElementById("uploadImagesForm"),e=new FormData(t);$.ajax({url:urls.uploadOthersImages,type:"POST",data:e,contentType:!1,cache:!1,processData:!1,success:function(t){var e=!0;if(null!=t&&t.length>0){var n=$.parseJSON(t);null!=n.error&&n.error.length>0&&(e=!1)}e&&reloadOthersImagesContainer(),$(".finish-upload .finish-text").show(),$(".finish-upload .loadUploadOthers").hide(),$("#modalMoreImages").modal("hide"),document.getElementById("uploadImagesForm").reset()}})})}function reloadOthersImagesContainer(){$(".others-images-container").empty(),$(".others-images-container").load(urls.loadOthersImages,{txt_folder:$('[name="txt_folder"]').val()})}function removeSecondaryProductImage(t,e,n){$.ajax({type:"POST",url:urls.removeSecondaryImage,data:{image:t,txt_folder:e}}).done(function(t){$("#image-container-"+n).remove()})}function updateCoordinators(t,e,n){$.ajax({type:"POST",url:urls.updateCoordinatorMapUrl,data:{productId:t,lng:e,lat:n}}).done(function(t){})}function defaultMap(){infoWindow=new google.maps.InfoWindow;var t={lat:14.0583,lng:108.2772};_map=new google.maps.Map(document.getElementById("map"),{zoom:5,center:t}),_marker=new google.maps.Marker({position:t,map:_map,label:"K"});var e=document.createElement("div"),n=document.createElement("strong");n.textContent="Việt Nam",e.appendChild(n),google.maps.event.addListener(_map,"click",function(t){_marker.setPosition(t.latLng),$("input[name=txt_lng]").val(t.latLng.lng()),$("input[name=txt_lat]").val(t.latLng.lat())}),infoWindow.setContent(e),infoWindow.open(_map,_marker)}function initMap(t,e,n){var a={lat:t,lng:e};_map.setZoom(17),_map.setCenter(a),_marker.setPosition(a);var o=document.createElement("strong");o.textContent=n;var i=document.createElement("div");i.appendChild(o),infoWindow.setContent(i),infoWindow.open(_map,_marker),_marker.addListener("click",function(){infoWindow.setContent(i),infoWindow.open(_map,_marker)})}function getGeoFromAddress(){var t=$("#txtCity").val(),e=$("#txtDistrict").val(),n=$("#txtWard").val(),a=$("#txt_street").val(),o="";a.length>1&&(o=a+", "),!isNaN(n)&&n>0&&(o+=$("#txtWard option:selected").text()+", "),!isNaN(e)&&e>0&&(o+=$("#txtDistrict option:selected").text()+", "),!isNaN(t)&&t>0&&(o+=$("#txtCity option:selected").text()+", "),o.length>2&&(o=o.substr(0,o.length-2)),_oldAddr!=o&&(_oldAddr=o,jQuery.ajax({type:"POST",url:urls.loadGeoFromAddrUrl,dataType:"json",data:{address:o},success:function(t){initMap(t[1],t[0],o),$("input[name=txt_lng]").val(t[0]),$("input[name=txt_lat]").val(t[1])}}))}function loadMap(t,e,n){initMap(t,e,n),$("input[name=txt_lng]").val(e),$("input[name=txt_lat]").val(t)}$(document).ready(function(){uploadMultipleImages(),loadDistrictByCityId(),loadWardByDistrictId(),autoComplete(),deletePostHandler(),refreshPostHandler(),activePostHandler(),inactivePostHandler(),$("#txtWard").change(function(){getGeoFromAddress()})});var _map,_marker,infoWindow,_oldAddr=null;
